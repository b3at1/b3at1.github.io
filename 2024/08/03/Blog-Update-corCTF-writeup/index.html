<!DOCTYPE html>
<img src="https://biggulpsupreme.neocities.org/mons.gif" alt="BIG GULP SUPREME" style="display: none;">
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Howdy, Everyone!I’m back again for my semiannual blog post! Honestly, this website has never been much of a priority for me, but I recently did some cool stuff and I wanted to share it here. Things I">
<meta property="og:type" content="article">
<meta property="og:title" content="Blog Update + corCTF 2024 forensics&#x2F;the-conspiracy writeup">
<meta property="og:url" content="https://b3at1.github.io/2024/08/03/Blog-Update-corCTF-writeup/index.html">
<meta property="og:site_name" content="b3at">
<meta property="og:description" content="Howdy, Everyone!I’m back again for my semiannual blog post! Honestly, this website has never been much of a priority for me, but I recently did some cool stuff and I wanted to share it here. Things I">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://b3at1.github.io/media/Blog-Update-corCTF-writeup/challengepcap.png">
<meta property="article:published_time" content="2024-08-03T16:49:00.587Z">
<meta property="article:modified_time" content="2024-08-03T17:48:16.873Z">
<meta property="article:author" content="Sam Bederman">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="blog update">
<meta property="article:tag" content="pcap">
<meta property="article:tag" content="forensics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://b3at1.github.io/media/Blog-Update-corCTF-writeup/challengepcap.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Blog Update + corCTF 2024 forensics/the-conspiracy writeup</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/b3at1">GitHub</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    
    <br/>
  <!-- TOC DISABLED
<div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Howdy-Everyone"><span class="toc-number">1.</span> <span class="toc-text">Howdy, Everyone!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Things-I-Learned-x2F-Did"><span class="toc-number">1.1.</span> <span class="toc-text">Things I Learned&#x2F;Did</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Life-Updates"><span class="toc-number">1.2.</span> <span class="toc-text">Life Updates</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#corCTF-2024-The-Conspiracy"><span class="toc-number">1.3.</span> <span class="toc-text">corCTF 2024 - The Conspiracy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#forensics-x2F-the-conspiracy"><span class="toc-number">1.3.1.</span> <span class="toc-text">forensics&#x2F;the-conspiracy</span></a></li></ol></li></ol></li></ol>
    </div>

  -->
    
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Blog Update + corCTF 2024 forensics/the-conspiracy writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Sam Bederman</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-08-03T16:49:00.587Z" itemprop="datePublished">2024-08-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/blog-update/" rel="tag">blog update</a>, <a class="tag-link-link" href="/tags/ctf/" rel="tag">ctf</a>, <a class="tag-link-link" href="/tags/forensics/" rel="tag">forensics</a>, <a class="tag-link-link" href="/tags/pcap/" rel="tag">pcap</a>, <a class="tag-link-link" href="/tags/writeup/" rel="tag">writeup</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="Howdy-Everyone"><a href="#Howdy-Everyone" class="headerlink" title="Howdy, Everyone!"></a>Howdy, Everyone!</h1><p>I’m back again for my semiannual blog post! Honestly, this website has never been much of a priority for me, but I recently did some cool stuff and I wanted to share it here.</p>
<h2 id="Things-I-Learned-x2F-Did"><a href="#Things-I-Learned-x2F-Did" class="headerlink" title="Things I Learned&#x2F;Did"></a>Things I Learned&#x2F;Did</h2><ul>
<li>played some ctfs</li>
<li>grinded for a 4.0 GPA (I’m not keeping it LOL)</li>
<li>summer hiking trip with friends</li>
<li>got my GCIH certification</li>
</ul>
<h2 id="Life-Updates"><a href="#Life-Updates" class="headerlink" title="Life Updates"></a>Life Updates</h2><p>I got an internship!!! I’m super grateful to have had the experience of working in Product Security (mainly AppSec) at Hitachi Energy this summer. I learned a lot about SSDLC and some of the specific tools that can be used to accomplish security at every gate of the software development process.</p>
<h2 id="corCTF-2024-The-Conspiracy"><a href="#corCTF-2024-The-Conspiracy" class="headerlink" title="corCTF 2024 - The Conspiracy"></a>corCTF 2024 - The Conspiracy</h2><p>Since I haven’t been posting writeups (or anything else as of recently) I think I’ll make it a tradition to always include a writeup in blog updates from now on. So here is a pretty fun challenge I solved during corCTF. corCTF was honestly pretty difficult for me, and I spent most of the ctf looking for a nonexistent prototype pollution on a web challenge. However, this forensics challenge wasn’t too challenging and was a lot of fun to solve.</p>
<h3 id="forensics-x2F-the-conspiracy"><a href="#forensics-x2F-the-conspiracy" class="headerlink" title="forensics&#x2F;the-conspiracy"></a>forensics&#x2F;the-conspiracy</h3><p>Author: jammy</p>
<p><code>Our intelligence team created a chat app, and secretly distributed it to the lemonthinker gang. We&#39;ve given you the application source and a capture taken by one of our agents - can you uncover their plans?</code></p>
<p>We are given a <code>challenge.pcap</code> file, as well as a <code>source.py</code></p>
<p>Let’s take a look at the source code first:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">sources, destinations, messages = [], [], []</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;chatlogs.csv&#x27;</span>, mode=<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    csv_reader = csv.reader(file)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> csv_reader:</span><br><span class="line">        sources.append(row[<span class="number">0</span>])</span><br><span class="line">        destinations.append(row[<span class="number">1</span>])</span><br><span class="line">        messages.append(row[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message</span>):</span><br><span class="line">    messagenums = []</span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> message:</span><br><span class="line">        messagenums.append(<span class="built_in">ord</span>(character))</span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(messagenums)):</span><br><span class="line">        keys.append(random.randint(<span class="number">10</span>, <span class="number">100</span>))</span><br><span class="line"></span><br><span class="line">    finalmessage = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(messagenums)):</span><br><span class="line">        finalmessage.append(messagenums[i] * keys[i])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keys, finalmessage</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(messages)):</span><br><span class="line">    finalmessage, keys = encrypt(messages[i])</span><br><span class="line">    <span class="built_in">print</span>(finalmessage, keys)</span><br><span class="line">    packet1 = IP(src=sources[i], dst=destinations[i])/TCP(dport=<span class="number">80</span>)/Raw(load=<span class="built_in">str</span>(finalmessage))</span><br><span class="line">    send(packet1)</span><br><span class="line">    packet2 = IP(src=sources[i], dst=destinations[i])/TCP(dport=<span class="number">80</span>)/Raw(load=<span class="built_in">str</span>(keys))</span><br><span class="line">    send(packet2)</span><br></pre></td></tr></table></figure>

<p>The code seems to be taking a csv containing chatlogs and encrypting them by generating a random number before multiplying the ASCII value of each character by that number. Luckily, two TCP packets are being sent out, with one containing the encrypted message and the other containing the list of keys used for each character in the message. The decryption is therefore very simple, as we just need to divide each character by the key it was encrypted with.</p>
<p>Investigating the tcp payloads inside of the packets in Wireshark, sure enough, it looks like our hypothesis about the source code is correct. The tcp payloads alternate lists of 2-digit numbers, and lists of 4-digit numbers (and the number 10000). The larger number represents the encrypted message, and the smaller numbers are the keys. Now we just have to extract these payloads and utilize the keys to decrypt the message.<br><img src="/media/Blog-Update-corCTF-writeup/challengepcap.png" alt="pcap file showing list of integers in TCP payload field"></p>
<p>Here’s the python script I created to solve the challenge:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scapy.<span class="built_in">all</span> <span class="keyword">import</span> rdpcap</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"><span class="comment"># read pcap</span></span><br><span class="line">packets = rdpcap(<span class="string">&#x27;challenge.pcap&#x27;</span>)</span><br><span class="line"></span><br><span class="line">tcp_data_segments = []</span><br><span class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> packets:</span><br><span class="line">    <span class="keyword">if</span> packet.haslayer(<span class="string">&#x27;TCP&#x27;</span>) <span class="keyword">and</span> packet[<span class="string">&#x27;TCP&#x27;</span>].payload:</span><br><span class="line">        <span class="comment"># extract tcp payload, parse it into a list of integers</span></span><br><span class="line">        payload = ast.literal_eval(<span class="built_in">bytes</span>(packet[<span class="string">&#x27;TCP&#x27;</span>].payload).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        <span class="comment"># append the list as a data segment</span></span><br><span class="line">        tcp_data_segments.append(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># parse alternating key,value lists and decode the secret message</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(tcp_data_segments), <span class="number">2</span>):</span><br><span class="line">    vals = tcp_data_segments[i]</span><br><span class="line">    keys = tcp_data_segments[i + <span class="number">1</span>]</span><br><span class="line">    decoded = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(vals[j] // keys[j]) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(keys)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;SEGMENT:&quot;</span>, decoded)</span><br></pre></td></tr></table></figure>
<p>After running it, I received the decrypted segments:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SEGMENT: hello blinkoid</span><br><span class="line">SEGMENT: hello night</span><br><span class="line">SEGMENT: how do we eliminate the msfroggers</span><br><span class="line">[...]</span><br><span class="line">SEGMENT: what&#x27;s our code again?</span><br><span class="line">SEGMENT: i think it&#x27;s corctf&#123;b@53d_af_f0r_th3_w1n&#125;</span><br></pre></td></tr></table></figure>

<p>I removed some of the output of the solve script to keep this post from getting too long, but there were a lot more decrypted segments showing a conversation. Anyway, this was my first time doing corCTF and while I feel like I was definitely in over my head, it was also really fun and a great learning experience. As always, thank you for reading and have a nice day!<br><br></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="http://github.com/b3at1">GitHub</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Howdy-Everyone"><span class="toc-number">1.</span> <span class="toc-text">Howdy, Everyone!</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Things-I-Learned-x2F-Did"><span class="toc-number">1.1.</span> <span class="toc-text">Things I Learned&#x2F;Did</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Life-Updates"><span class="toc-number">1.2.</span> <span class="toc-text">Life Updates</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#corCTF-2024-The-Conspiracy"><span class="toc-number">1.3.</span> <span class="toc-text">corCTF 2024 - The Conspiracy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#forensics-x2F-the-conspiracy"><span class="toc-number">1.3.1.</span> <span class="toc-text">forensics&#x2F;the-conspiracy</span></a></li></ol></li></ol></li></ol>
    </div>


  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2024
    Sam Bederman
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/b3at1">GitHub</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
